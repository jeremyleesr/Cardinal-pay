<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Pay Tracker">
    <title>Trucker Pay Tracker</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

<div class="bottom-nav">
    <button class="nav-button active" onclick="showDashboard()"><div class="nav-icon">ğŸ“Š</div>Dashboard</button>
    <button class="nav-button"><div class="nav-icon">ğŸ“…</div>History</button>
    <button class="nav-button" onclick="showTrucksPage()"><div class="nav-icon">ğŸšš</div>Trucks</button>
    <button class="nav-button" onclick="showSettingsPage()"><div class="nav-icon">âš™ï¸</div>Settings</button>
</div>

<!-- DASHBOARD PAGE -->
<div class="container">
    <div class="week-totals">
        <h2 style="font-size: 14px; opacity: 0.8; text-transform: uppercase;">Pay Summary</h2>
        <div style="display: flex; justify-content: space-between; margin-top: 10px;">
            <span>Last Week:</span>
            <span style="font-weight: 700;">$0.00</span>
        </div>
        <div class="total-row current">
            <span style="font-size: 16px;">This Week:</span>
            <span id="thisWeekTotal">$0.00</span>
        </div>
        <div style="background: rgba(255,255,255,0.2); padding: 10px; border-radius: 8px; margin-top: 12px;">
            <div style="display: flex; justify-content: space-between;">
                <span>Today:</span>
                <span id="dailyTotal" style="font-weight: 700;">$0.00</span>
            </div>
            <div id="routeCount" style="font-size: 12px; margin-top: 5px; opacity: 0.9;">No routes saved today</div>
        </div>
    </div>

    <div id="savedRoutesDisplay" class="hidden" style="margin-bottom: 20px;">
        <h3 style="font-size: 16px; color: #667eea; margin-bottom: 12px;">Saved Routes Today</h3>
        <div id="savedRoutesList" style="display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px;"></div>
    </div>

    <div class="entry-form">
        <div class="form-header">
            <h2 style="color: #333; font-size: 20px;">New Route</h2>
            <div class="route-number" id="routeNumberDisplay">Route #1</div>
        </div>

        <div style="margin-bottom: 20px;">
            <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">Shift Date</label>
            <input type="date" id="shiftDate">
        </div>

        <div class="form-section">
            <h3 style="font-size: 16px; margin-bottom: 10px;">ğŸš› Miles</h3>
            <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">Total Miles Driven</label>
            <input type="number" id="miles" placeholder="0" inputmode="decimal">
            <div class="calculated-display">
                <div class="pay-amount" id="milesCalc">$0.00</div>
            </div>
        </div>

        <div class="form-section">
            <h3 style="font-size: 16px; margin-bottom: 10px;">ğŸ“ Stops</h3>
            <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">Number of Stops</label>
            <input type="number" id="stops" placeholder="0" inputmode="numeric">
            <div class="calculated-display">
                <div class="pay-amount" id="stopsCalc">$0.00</div>
            </div>
        </div>

        <div class="form-section">
            <h3 style="font-size: 16px; margin-bottom: 10px;">ğŸ”„ Backhauls/Pickups</h3>
            <div id="backhaulsContainer"></div>
            <button class="add-button" onclick="openBackhaulModal()">+ Add Backhaul/Pickup</button>
        </div>

        <div class="form-section">
            <h3 style="font-size: 16px; margin-bottom: 10px;">â° Detention/Breakdown</h3>
            <div id="detentionContainer"></div>
            <button class="add-button" onclick="addDetention()">+ Add Detention/Breakdown</button>
        </div>

        <div class="form-section">
            <h3 style="font-size: 16px; margin-bottom: 10px;">ğŸ­ Yard Driver</h3>
            <div id="yardContainer"></div>
            <button class="add-button" onclick="addYard()">+ Add Yard Time</button>
        </div>

        <div class="form-section">
            <h3 style="font-size: 16px; margin-bottom: 10px;">ğŸ½ï¸ Per Diem</h3>
            <div class="checkbox-group">
                <input type="checkbox" id="perDiem" onchange="updateRouteTotal()">
                <label for="perDiem" style="font-size: 15px;">Per Diem ($50.00)</label>
            </div>
        </div>

        <div class="form-section">
            <h3 style="font-size: 16px; margin-bottom: 10px;">ğŸ“ Other</h3>
            <div id="otherContainer"></div>
            <button class="add-button" onclick="addOther()">+ Add Other</button>
        </div>

        <div style="margin-top: 20px; padding: 15px; background: #667eea; border-radius: 12px; color: white;">
            <div style="display: flex; justify-content: space-between; align-items: center;">
                <span style="font-weight: 600;">Route Total:</span>
                <span id="routeTotal" style="font-size: 24px; font-weight: 800;">$0.00</span>
            </div>
        </div>
    </div>
</div>

<!-- TRUCKS PAGE -->
<div class="container hidden" id="trucksPage">
    <div style="background: white; padding: 20px; border-radius: 16px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
        <h2 style="font-size: 24px; color: #333; margin-bottom: 20px;">Truck Management</h2>
        
        <div style="margin-bottom: 15px;">
            <input type="text" id="truckSearch" placeholder="Search truck number..." style="width: 100%; padding: 14px; border: 1px solid #ddd; border-radius: 12px; font-size: 16px; background: #fafafa;" oninput="filterTrucks()">
        </div>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr 1fr; gap: 8px; margin-bottom: 15px;">
            <button id="filterAll" class="filter-btn active" onclick="setTruckFilter('all')" style="background: #667eea; color: white; border: none; padding: 10px; border-radius: 8px; font-weight: 600; font-size: 14px;">All</button>
            <button id="filterGreen" class="filter-btn" onclick="setTruckFilter('green')" style="background: #eee; color: #666; border: none; padding: 10px; border-radius: 8px; font-weight: 600; font-size: 14px;">ğŸŸ¢ Good</button>
            <button id="filterYellow" class="filter-btn" onclick="setTruckFilter('yellow')" style="background: #eee; color: #666; border: none; padding: 10px; border-radius: 8px; font-weight: 600; font-size: 14px;">ğŸŸ¡ Okay</button>
            <button id="filterRed" class="filter-btn" onclick="setTruckFilter('red')" style="background: #eee; color: #666; border: none; padding: 10px; border-radius: 8px; font-weight: 600; font-size: 14px;">ğŸ”´ Avoid</button>
        </div>
        
        <button class="save-route-button" style="position: relative; margin-bottom: 0;" onclick="openAddTruckModal()">+ Add New Truck</button>
    </div>

    <div style="margin-bottom: 30px;">
        <h3 style="font-size: 20px; color: #667eea; margin-bottom: 15px;">ğŸ›ï¸ Sleeper Trucks</h3>
        <div id="sleeperTrucksList"></div>
        <div id="noSleepers" style="text-align: center; padding: 30px; color: #999;">No sleeper trucks match your filters</div>
    </div>

    <div>
        <h3 style="font-size: 20px; color: #667eea; margin-bottom: 15px;">ğŸš› Day Cabs</h3>
        <div id="dayCabsList"></div>
        <div id="noDayCabs" style="text-align: center; padding: 30px; color: #999;">No day cabs match your filters</div>
    </div>
</div>

<!-- SETTINGS PAGE -->
<div class="container hidden" id="settingsPage">
    <div style="background: white; padding: 20px; border-radius: 16px; margin-bottom: 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05);">
        <h2 style="font-size: 24px; color: #333; margin-bottom: 10px;">Settings</h2>
        <p style="font-size: 14px; color: #666; margin-bottom: 20px;">Manage your data, backups, and preferences</p>
        
        <div style="margin-bottom: 30px;">
            <h3 style="font-size: 18px; color: #667eea; margin-bottom: 15px;">ğŸ“ Files & Backup</h3>
            
            <button class="save-route-button" style="background: #4CAF50; margin-bottom: 12px;" onclick="exportBackup()">
                ğŸ’¾ Save Backup Now
            </button>
            <p style="font-size: 13px; color: #666; margin-bottom: 20px; padding-left: 10px;">
                Export all your data to a file. Save to Google Drive, email yourself, or AirDrop to computer.
            </p>
            
            <button class="save-route-button" style="background: #2196F3; margin-bottom: 12px;" onclick="importBackup()">
                ğŸ“¥ Restore from Backup
            </button>
            <p style="font-size: 13px; color: #666; margin-bottom: 20px; padding-left: 10px;">
                Import a previously saved backup file. Warning: This replaces all current data.
            </p>
        </div>
        
        <div style="margin-bottom: 30px;">
            <h3 style="font-size: 18px; color: #667eea; margin-bottom: 15px;">ğŸ’° Pay Rates</h3>
            <p style="font-size: 14px; color: #999; font-style: italic;">
                Coming soon: Edit default mileage brackets, stop pay, detention rates, etc.
            </p>
        </div>
        
        <div style="border-top: 2px solid #ffebee; padding-top: 20px;">
            <h3 style="font-size: 18px; color: #f44336; margin-bottom: 15px;">âš ï¸ Danger Zone</h3>
            <button onclick="clearAllData()" style="background: #f44336; color: white; border: none; padding: 14px; border-radius: 12px; font-weight: 600; width: 100%; margin-bottom: 10px;">
                ğŸ—‘ï¸ Clear All Data
            </button>
            <p style="font-size: 13px; color: #999; padding-left: 10px;">
                Warning: This permanently deletes all routes, trucks, and stores. Export a backup first!
            </p>
        </div>
    </div>
</div>

<!-- ACTION BUTTONS -->
<div class="action-container">
    <button class="save-route-button" onclick="saveRoute()">Save Current Route</button>
    <div class="secondary-actions">
        <button class="new-route-btn" onclick="startNewRoute()">+ New Route</button>
        <button class="end-day-btn" onclick="endDay()">End Day</button>
    </div>
</div>

<!-- MODALS -->
<div class="modal" id="backhaulModal">
    <div class="modal-content">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h3>Select Store</h3>
            <button onclick="closeBackhaulModal()" style="border: none; background: #eee; width: 30px; height: 30px; border-radius: 50%; font-size: 18px;">Ã—</button>
        </div>
        <div id="backhaulList"></div>
        <button class="add-button" style="margin-top: 15px;" onclick="openAddStoreForm()">+ Add New Store</button>
    </div>
</div>

<div class="modal" id="addStoreModal">
    <div class="modal-content">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h3>Add New Store</h3>
            <button onclick="closeAddStoreForm()" style="border: none; background: #eee; width: 30px; height: 30px; border-radius: 50%; font-size: 18px;">Ã—</button>
        </div>
        <div style="margin-bottom: 15px;">
            <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">Store Number</label>
            <input type="text" id="newStoreNumber" placeholder="e.g., A123, DC45">
        </div>
        <div style="margin-bottom: 15px;">
            <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">Store Name</label>
            <input type="text" id="newStoreName" placeholder="e.g., Walmart DC">
        </div>
        <div style="margin-bottom: 15px;">
            <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">Notes</label>
            <textarea id="newStoreNotes" placeholder="Road temps, tire pressure, dock info..." rows="5"></textarea>
        </div>
        <button class="save-route-button" onclick="saveNewStore()">Save Store</button>
    </div>
</div>

<div class="modal" id="notesModal">
    <div class="modal-content">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h3 id="notesModalTitle">Store Notes</h3>
            <button onclick="closeNotesModal()" style="border: none; background: #eee; width: 30px; height: 30px; border-radius: 50%; font-size: 18px;">Ã—</button>
        </div>
        <div style="background: #f0f7ff; padding: 12px; border-radius: 8px; margin-bottom: 15px;">
            <div style="font-size: 14px; color: #666;">Store Number</div>
            <div style="font-weight: 600; font-size: 16px;" id="notesStoreNumber"></div>
        </div>
        <div style="margin-bottom: 15px;">
            <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">Notes</label>
            <textarea id="editStoreNotes" rows="8"></textarea>
        </div>
        <button class="save-route-button" onclick="saveEditedNotes()">Save Notes</button>
    </div>
</div>

<div class="modal" id="truckModal">
    <div class="modal-content">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
            <h3 id="truckModalTitle">Add New Truck</h3>
            <button onclick="closeTruckModal()" style="border: none; background: #eee; width: 30px; height: 30px; border-radius: 50%; font-size: 18px;">Ã—</button>
        </div>
        
        <div style="margin-bottom: 15px;">
            <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">Truck Number</label>
            <input type="text" id="truckNumber" placeholder="e.g., 123, A45">
        </div>
        
        <div style="margin-bottom: 15px;">
            <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">Type</label>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <button id="typeSleeper" class="add-button" style="margin: 0;" onclick="selectTruckType('sleeper')">Sleeper</button>
                <button id="typeDayCab" class="add-button" style="margin: 0;" onclick="selectTruckType('daycab')">Day Cab</button>
            </div>
        </div>
        
        <div id="sleeperStatus" class="hidden" style="margin-bottom: 15px;">
            <label style="font-size: 13px; color: #666; margin-bottom: 8px; display: block;">Status</label>
            <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                <button class="status-btn" data-status="green" onclick="setSleeperStatus('green')" style="background: #4CAF50; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600;">ğŸŸ¢ Good</button>
                <button class="status-btn" data-status="yellow" onclick="setSleeperStatus('yellow')" style="background: #FFC107; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600;">ğŸŸ¡ Okay</button>
                <button class="status-btn" data-status="red" onclick="setSleeperStatus('red')" style="background: #f44336; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600;">ğŸ”´ Avoid</button>
            </div>
        </div>
        
        <div id="dayCabStatus" class="hidden">
            <div style="margin-bottom: 15px;">
                <label style="font-size: 13px; color: #666; margin-bottom: 8px; display: block;">Local Status</label>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                    <button class="local-status-btn" data-status="green" onclick="setLocalStatus('green')" style="background: #4CAF50; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600;">ğŸŸ¢ Good</button>
                    <button class="local-status-btn" data-status="yellow" onclick="setLocalStatus('yellow')" style="background: #FFC107; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600;">ğŸŸ¡ Okay</button>
                    <button class="local-status-btn" data-status="red" onclick="setLocalStatus('red')" style="background: #f44336; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600;">ğŸ”´ Avoid</button>
                </div>
            </div>
            <div style="margin-bottom: 15px;">
                <label style="font-size: 13px; color: #666; margin-bottom: 8px; display: block;">Distance Status</label>
                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px;">
                    <button class="distance-status-btn" data-status="green" onclick="setDistanceStatus('green')" style="background: #4CAF50; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600;">ğŸŸ¢ Good</button>
                    <button class="distance-status-btn" data-status="yellow" onclick="setDistanceStatus('yellow')" style="background: #FFC107; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600;">ğŸŸ¡ Okay</button>
                    <button class="distance-status-btn" data-status="red" onclick="setDistanceStatus('red')" style="background: #f44336; color: white; border: none; padding: 12px; border-radius: 8px; font-weight: 600;">ğŸ”´ Avoid</button>
                </div>
            </div>
        </div>
        
        <div style="margin-bottom: 15px;">
            <label style="font-size: 13px; color: #666; margin-bottom: 5px; display: block;">Notes</label>
            <textarea id="truckNotes" rows="6" placeholder="Seat comfort, known issues, APU status, speed limit, etc."></textarea>
        </div>
        
        <button class="save-route-button" onclick="saveTruck()">Save Truck</button>
        <button id="deleteTruckBtn" class="hidden" onclick="deleteTruck()" style="background: #f44336; color: white; border: none; padding: 14px; border-radius: 12px; font-weight: 600; width: 100%; margin-top: 10px;">Delete Truck</button>
    </div>
</div>

<script src="app.js"></script>
</body>
</html>
